# Basic utilities
# grep
alias grep='grep -i --color=always'
alias rgg="rg -g '!*test*' -g '!*spec*'"
alias pg="rg -g '*\.py' -g '*\.rb'"
alias pgg="rgg -g '*\.py' -g '*\.rb'"

# find process
alias pf="ps aux | grep"
alias fp="lsof -aPi -p"

# ipython
alias p='ipython'

# ls
# LS_BASE="ls -AFGh --color=always"
# alias l="$LS_BASE"
# alias ll="$LS_BASE -gl"
# alias lS="$LS_BASE -glS"
# alias lt="$LS_BASE -glt"
# alias ls="ls -FG "

#new ls stuff
EXA_BASE="exa --icons --long --color=always --reverse"
alias ll="$EXA_BASE --all"
alias lt="$EXA_BASE --all --sort=changed"
alias lS="$EXA_BASE --all --sort=size"
alias la="$EXA_BASE --all --sort=accessed"
alias ls="$EXA_BASE"
alias lx="$EXA_BASE --sort=ext"
alias l="exa --grid --all"
alias lpy="$EXA_BASE | grep r'*.py'"


#manpage
alias man='tldr'


# vim
alias v='nvim'
alias vi='nvim'

# which
alias w='which'

# Git
GIT_BASE="git"
alias g="$GIT_BASE"

# add
alias add="$GIT_BASE add"
alias ap="$GIT_BASE add --intent-to-add . && $GIT_BASE add -p"

# branch
alias br="$GIT_BASE branch"

function brd {
REMOTE_BRANCHES="$($GIT_BASE ls-remote --heads | awk '{print $2}' | cut -c 12-)"
SE branch | grep -v 'master$' | grep -v $REMOTE_BRANCHES | xargs $GIT_BASE branch -D
}

# clone
alias clone="$GIT_BASE clone"

# commit
alias ca="$GIT_BASE commit -v --amend --no-edit"
alias cm="$GIT_BASE commit -v"

# checkout
alias co="$GIT_BASE checkout"
alias cb="$GIT_BASE checkout -b"
alias ma="$GIT_BASE checkout master"

# diff
alias d="$GIT_BASE diff --name-status"
alias dd="$GIT_BASE diff"

# log
alias gl="$GIT_BASE log --oneline --pretty=format:'%C(Green)%h %C(red)%an %C(blue)%cr %C(cyan)%s'"
# l used for ls
alias gll="$GIT_BASE log"
alias glp="$GIT_BASE log -p"
alias blame="$GIT_BASE blame"
alias gf='$GIT_BASE reflog'

# push
alias push="$GIT_BASE push"

# rebase
alias re="$GIT_BASE rebase"

#rename branch
function branch-rename {
    # renames the local branch and on ALL remotes
    $GIT_BASE branch -m $1 $2
    for remote in $(git remote)
    do
        $GIT_BASE push $remote -u $2
        $GIT_BASE push $remote --delete $1
    done
}

# pull
alias pull="$GIT_BASE pull"

# status
alias st="$GIT_BASE status"

# show
alias show="$GIT_BASE show"

# stashing
alias stash="$GIT_BASE stash"
alias pop="$GIT_BASE stash pop"

# reflog
alias reflog='git reflog --pretty=raw | tig --pretty=raw'

# reset
alias reset="$GIT_BASE reset"

# stats
alias gg='$GIT_BASE shortlog -sn --since="1 week"'

# Code management
# Lint
# js
alias lint="npm run mac-lint"

# Container management
# Docker
alias dk="docker"

# K8s
KUBECTL_BASE="kubectl"

alias k="$KUBECTL_BASE"

alias kg="$KUBECTL_BASE get"
alias kgp="$KUBECTL_BASE get pod"

alias kd="$KUBECTL_BASE describe"
alias kdp="$KUBECTL_BASE describe pod"

alias kl="$KUBECTL_BASE logs"
alias klf="$KUBECTL_BASE logs -f"

function ksh {
KSH_CMD="$KUBECTL_BASE exec -it $@ -- /bin/bash"
eval ${KSH_CMD}
}


# Dev tools

function virtualenv_info {
    [ $VIRTUAL_ENV ] && echo '('`basename $VIRTUAL_ENV`') '
}

# Password Tools
ONEPASS_BASE='1pass'
alias oplogin="$ONEPASS_BASE -rv"
alias opls='$ONEPASS_BASE -l'

function opfind {
    echo $($ONEPASS_BASE -l |grep "$1")
}

function opgp {
    declare input=$(opfind omni) < /dev/stdin ; opgp $input
}

# Pytest
alias it='pytest -rEf --ds config.settings.integration_test -m integration -s --no-cov --reuse-db'
alias ut='pytest -rEf --no-cov --ds config.settings.test -m "not integration" -s'

#networking
alias localip="sudo ifconfig | grep -Eo 'inet (addr:)?([0-9]*\\.){3}[0-9]*' | grep -Eo '([0-9]*\\.){3}[0-9]*' | grep -v '127.0.0.1'"
alias httpdump="sudo tcpdump -i en1 -n -s 0 -w - | grep -a -o -E \"Host\\: .*|GET \\/.*\""

#ssh
alias keyup='. ssh-agent-init;ssh-keychain-init'

EP_USER='gpappu'
DEV_VM='gautam-breaks-things.gpappu.devvm.easypo.net'
BASTION_HOST='admin.dev.easypo.net'
ADMIN_HOST='admin.easypo.net'

alias easytunnel="ssh -L 1080:proxy.local.easypo.net:1080 -N -C $EP_USER@{BASTION_HOST}"

function devbox() {
	ssh dev -t 'tmux -CC new-session -A -s epdevbox' 2>&1
}

function adminbox() {
	ssh admin -t 'tmux -CC new-session -A -s epadmin' 2>&1
}

hash -d d="$HOME/dotfiles"
hash -d hq="$HOME/easypost"

alias hq='~hq'

#replacements
alias cat='bat'
alias mv='mv -iv'
alias rmm='rm -Iv'
alias bd='batdiff'
alias pb='prettybat'
alias bw='batwatch'

alias reload="source ~/.zshrc"
